<html>
<head>
    <title>{{ name }}</title>
    <link href="{{ url_for('static', path='/result.css') }}" rel="stylesheet">
</head>
<body>
    <image id="content" src=""></image>


    <div class="divTable">
        <div class="headRow">
           <div class="divCell" align="center">Parameter</div>
           <div  class="divCell" align="center">Value</div>
        </div>
       <div class="divRow">
           <div class="divCell">Speed</div>
           <div class="divCell" id="speedValue"></div>
       </div>
       <div class="divRow">
           <div class="divCell">Direction</div>
           <div class="divCell" id="directionValue"></div>
      </div>
       <div class="divRow">
           <div class="divCell">Color</div>
           <div class="divCell" id="colorValue"></div>
      </div>
      <div class="divRow">
        <div class="divCell">Count</div>
        <div class="divCell" id="countValue"></div>
      </div>
      <div class="divRow">
        <div class="divCell">Condition</div>
        <div class="divCell" id="countValue"></div>
      </div>
 </div>
    
    <script>
        function encode (input) {
            var keyStr = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
            var output = "";
            var chr1, chr2, chr3, enc1, enc2, enc3, enc4;
            var i = 0;

            while (i < input.length) {
                chr1 = input[i++];
                chr2 = i < input.length ? input[i++] : Number.NaN; // Not sure if the index 
                chr3 = i < input.length ? input[i++] : Number.NaN; // checks are needed here

                enc1 = chr1 >> 2;
                enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);
                enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);
                enc4 = chr3 & 63;

                if (isNaN(chr2)) {
                    enc3 = enc4 = 64;
                } else if (isNaN(chr3)) {
                    enc4 = 64;
                }
                output += keyStr.charAt(enc1) + keyStr.charAt(enc2) +
                        keyStr.charAt(enc3) + keyStr.charAt(enc4);
            }
            return output;
        }

        var ws = new WebSocket("ws://{{ server_url }}/cameras/{{ id }}/ws");
        ws.onmessage = function(msg) {
            var base64image = JSON.parse(msg.data)["data"];
            console.log(base64image)
            // var bytes = new Uint8Array(arrayBuffer);

            var image = document.getElementById('content');
            image.src = 'data:image/jpeg;base64,' + base64image;
        };
    </script>
</body>
</html>